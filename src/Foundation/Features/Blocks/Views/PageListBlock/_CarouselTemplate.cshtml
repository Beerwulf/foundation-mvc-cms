@using EPiServer.AddOns.Helpers
@using EPiServer.Core.Html
@model PageListBlockViewModel



<link rel="stylesheet" type="text/css" href="~/Assets/js/vendors/slick/slick.css">
<link rel="stylesheet" type="text/css" href="~/Assets/js/vendors/slick/slick-theme.css">
<style type="text/css">
    .slider {
        width: 100%;
        margin: 100px auto;
    }

    .slick-slide {
        margin: 0px 20px;
    }

        .slick-slide img {
            width: 100%;
        }

    .slick-prev:before, .slick-next:before {
        color: black;
    }

    .slick-slide {
        transition: all ease-in-out .3s;
        opacity: .2;
    }

    .slick-active {
        opacity: .5;
    }

    .slick-current {
        opacity: 1;
    }
</style>


@if (Model.Pages != null && Model.Pages.Any())
{
    <div class="regular slider">

        @{
            int active = 0;

            foreach (var page in Model.Pages)
            {
                var foundationPage = page.Page as FoundationPageData;
                var CSSActive = (active == 0) ? "active" : "";


                <div class="preview__card">
                    <div class="preview__card--show">
                        <div class="card--top">
                            @if (page != null && !ContentReference.IsNullOrEmpty(foundationPage.TeaserVideo))
                            {
                                <video class="img-fluid" autoplay loop playsinline muted>
                                    <source src="@Url.ContentUrl(foundationPage.TeaserVideo)" type="video/mp4">
                                </video>
                            }
                            else
                            {
                                <picture style="width: 100%">
                                    @if (page != null && !ContentReference.IsNullOrEmpty(foundationPage.PageImage))
                                    {
                                        <img class="img-fluid preview--image-top__image" src="@Url.WebPFallbackImageUrl(foundationPage.PageImage, 1200)" />
                                    }
                                </picture>
                            }
                        </div>

                        <div class="card--bottom">
                            <div class="card--bottom__title">
                                <a class="account-link">
                                    <h4>  @Html.Raw(page != null ? foundationPage.MetaTitle : page.Page.Name)</h4>
                                </a>
                                @if (page != null && !String.IsNullOrEmpty(foundationPage.TeaserText))
                                {
                                    <p>@Html.Raw(TextIndexer.StripHtml(foundationPage.TeaserText, 150))</p>
                                }
                                else
                                {
                                    <p>@Html.Raw(TextIndexer.StripHtml(foundationPage.MainBody.ToString(), 150))</p>
                                }

                            </div>
                            <div class="card--bottom__date">
                                <small>
                                    <i>
                                        @foundationPage.StartPublish.Value.ToString("dd MMM yyyy")
                                    </i>
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="preview__card--middle">
                        <div class="triangle-side"></div>
                        <div class="triangle-center"></div>
                        <div class="triangle-side"></div>
                    </div>
                    <div class="preview__card--overlay"
                         style="background-color: @Model.CurrentBlock.OverlayColor; color: @Model.CurrentBlock.OverlayTextColor">
                        <div class="preview__card--description">
                            @if (page != null && !String.IsNullOrEmpty(foundationPage.TeaserText))
                            {
                                <p>@Html.Raw(TextIndexer.StripHtml(foundationPage.TeaserText, 200))</p>
                            }
                            else
                            {
                                <p>@Html.Raw(TextIndexer.StripHtml(foundationPage.MainBody.ToString(), 200))</p>
                            }

                            <a href="@foundationPage.ContentLink.GetPublicUrl()">
                                Read more
                            </a>
                        </div>
                    </div>
                </div>



                active++;
            }
        }



    </div>



}

@*<div class="regular slider">
    <div>
        <img src="http://placehold.it/350x300?text=1">
    </div>
    <div>
        <img src="http://placehold.it/350x300?text=2">
    </div>
    <div>
        <img src="http://placehold.it/350x300?text=3">
    </div>
    <div>
        <img src="http://placehold.it/350x300?text=4">
    </div>
    <div>
        <img src="http://placehold.it/350x300?text=5">
    </div>
    <div>
        <img src="http://placehold.it/350x300?text=6">
    </div>
</div>*@




<script src="~/Assets/js/vendors/slick/slick.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    jQuery(document).ready(function ($) {

        $(".regular").slick({
            dots: true,
            infinite: true,
            slidesToShow: 3,
            slidesToScroll: 1
        });

    });
</script>
